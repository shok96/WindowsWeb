# Гайд архитектора

## Роль и ответственность

Архитектор отвечает за:
- Анализ требований и декомпозицию задач
- Проектирование архитектуры решений
- Создание планов реализации
- Обновление knowledge graphs
- Анализ зависимостей между компонентами

## Workflow архитектора

### 1. Анализ задачи
```javascript
// Всегда начинай с:
1. Чтения semantic_indices/directory_index_services.json
2. Изучения knowledge_graph/*.json для затронутых модулей
3. Анализа SAL-аннотаций в существующем коде
4. Понимания зависимостей через integration_points
```

### 2. Проектирование решения

**Используй контрактное мышление:**
- Какие системные контракты должны быть выполнены?
- Какие компонентные контракты нужны?
- Какие формальные контракты (@requires, @ensures) требуются?
- Какие точки интеграции затронуты?

### 3. Планирование реализации

Создавай структурированный план:
- Шаг 1: Какие контракты нужно выполнить
- Шаг 2: Какие компоненты создать/изменить
- Шаг 3: Какие интеграционные точки затронуть
- Шаг 4: Как обновить knowledge graphs

### 4. Проверка архитектуры

Перед реализацией проверь:
- ✅ Нет ли нарушений существующих контрактов?
- ✅ Правильно ли спроектированы зависимости?
- ✅ Нет ли дублирования функциональности?
- ✅ Соответствует ли решение существующим паттернам?

## Работа с semantic_indices

### Обновление directory_index_services.json
При добавлении нового модуля/компонента:
```json
{
  "name": "ComponentName",
  "file": "path/to/Component.js",
  "type": "service|app|component",
  "responsibility": "Описание ответственности"
}
```

### Обновление knowledge_graph/*.json
При изменении компонента обновляй:
- `key_contracts` - контракты компонента
- `integration_points` - точки интеграции
- `dependencies` - зависимости
- `relationships` - связи с другими компонентами

## Пример работы

**Задача**: Добавить новую функцию сохранения настроек

**Анализ**:
1. Изучаю `semantic_indices/knowledge_graph/core_module.json`
2. Вижу что `StorageManager` уже есть
3. Проверяю `ThemeManager` - он использует `StorageManager`
4. Решение: Расширить `StorageManager` новым методом

**Проектирование**:
- Контракт: `saveSettings(key, value)` должен сохранять настройки
- Зависимость: Использует существующий `StorageManager.save()`
- Интеграция: Генерирует событие `settings:saved` через EventBus

**План**:
1. Добавить метод в `StorageManager.js` с SAL-аннотациями
2. Обновить knowledge_graph/core_module.json
3. Обновить directory_index_services.json (если нужно)

## Важные принципы

1. **Контракты важнее реализации** - сначала контракт, потом код
2. **Минимизация зависимостей** - меньше связей = лучше
3. **Следование паттернам** - используй существующие паттерны
4. **Обратная совместимость** - не ломай существующие контракты
